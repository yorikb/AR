<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>MindAR Fullscreen AR (–ö–ª–æ–Ω—É–≤–∞–Ω–Ω—è –º–æ–¥–µ–ª—ñ)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />

    <!-- A-Frame & MindAR.js -->
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>

    <!-- Fullscreen CSS -->
    <style>
      html, body { margin: 0; padding: 0; height: 100%; overflow: hidden; }
      a-scene { position: absolute; top: 0; left: 0; width: 100% !important; height: 100% !important; }
    </style>
  </head>

  <body>
    <a-scene
    mindar-image="imageTargetSrc: ./marker.mind; autoStart: true;"
      embedded
      color-space="sRGB"
      renderer="colorManagement: true, physicallyCorrectLights"
      vr-mode-ui="enabled: false"
      device-orientation-permission-ui="enabled: true"
    >
      <a-assets>
        <a-asset-item
          id="modelAsset"
          src="https://raw.githubusercontent.com/KhronosGroup/glTF-Sample-Models/master/2.0/DamagedHelmet/glTF-Binary/DamagedHelmet.glb"
        ></a-asset-item>
      </a-assets>

      <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>

      <!-- –Ø–∫—ñ—Ä –Ω–∞ –º—ñ—Ç—Ü—ñ -->
      <a-entity id="anchor" mindar-image-target="targetIndex: 0">
        <!-- –ü–æ—á–∞—Ç–∫–æ–≤–∏–π "–ø—Ä–∏—Ö–æ–≤–∞–Ω–∏–π" –ø—Ä–∏–∫–ª–∞–¥ –º–æ–¥–µ–ª—ñ -->
        <a-gltf-model
          id="templateModel"
          src="#modelAsset"
          scale="0,5 0,5 0,5"
          position="0 0 -1"
          visible="false"
        ></a-gltf-model>
      </a-entity>
    </a-scene>

    <script>
      // –•–∞–∫ –¥–ª—è –º–æ–±—ñ–ª—å–Ω–æ–≥–æ Chrome
      window.addEventListener("load", () => {
        setTimeout(() => { window.scrollTo(0, 1); }, 100);
      });

      document.addEventListener("DOMContentLoaded", () => {
        const sceneEl   = document.querySelector("a-scene");
        const anchorEl  = document.querySelector("#anchor");
        const template  = document.querySelector("#templateModel");

        let modelReady = false;
        let spawned    = false;

        // –ü–µ—Ä–µ–∫–æ–Ω—É—î–º–æ—Å—è, —â–æ –º–æ–¥–µ–ª—å –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∞
        template.addEventListener("model-loaded", () => {
          console.log("‚úÖ –ì–æ—Ç–æ–≤–æ: —à–∞–±–ª–æ–Ω –º–æ–¥–µ–ª—ñ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ");
          modelReady = true;
        });

        // –ö–æ–ª–∏ –±–∞—á–∏–º–æ –º—ñ—Ç–∫—É ‚Äî –∫–ª–æ–Ω—é—î–º–æ –º–æ–¥–µ–ª—å —ñ "—Å—Ç–∞–≤–∏–º–æ" —É –∫—ñ–º–Ω–∞—Ç—ñ
        anchorEl.addEventListener("targetFound", () => {
          console.log("üéØ –ü–æ–¥—ñ—è targetFound");
          if (modelReady && !spawned) {
            spawned = true;
            // –ö–ª–æ–Ω
            const clone = template.cloneNode(true);
            clone.setAttribute("visible", "true");
            // –°—Ç–∞–≤–∏–º–æ –ø–µ—Ä–µ–¥ –∫–∞–º–µ—Ä–æ—é
            clone.setAttribute("position", "0 0 0");
            clone.setAttribute("rotation", "0 0 0");
            clone.setAttribute("scale", "0,2 0,2 0,2");
            clone.removeAttribute("id");  // —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π, —â–æ–± –Ω–µ –±—É–ª–æ –¥—É–±–ª—ñ–∫–∞—Ç—ñ–≤
            sceneEl.appendChild(clone);
            console.log("üì¶ –ö–ª–æ–Ω –º–æ–¥–µ–ª—ñ —Å—Ç–≤–æ—Ä–µ–Ω–æ —Ç–∞ –¥–æ–¥–∞–Ω–æ –¥–æ —Å—Ü–µ–Ω–∏");
          }
        });
      });
    </script>
  </body>
</html>
